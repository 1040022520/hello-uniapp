!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("vue")):"function"==typeof define&&define.amd?define(["vue"],e):e((t=t||self).Vue)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={onLaunch:function(){},onHide:function(){},onShow:function(){}};function a(t,e,a){if(t[e]){var i=t[e];t[e]=function(t){i.call(this,t),a.call(this,t,e)}}else t[e]=function(t){a.call(this,t,e)}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}var p="0.0.2",r=require("crypto");function _(t){var e=Object.keys(t).sort(),a={},i="";for(var n in e)a[e[n]]=t[e[n]],i+=e[n]+"="+t[e[n]]+"&";var s=i.substr(0,i.length-1);return i=i.substr(0,i.length-1)+"&key=qkTHEIegZGcL5iy3",{sign:r.createHash("md5").update(i).digest("hex"),options:s}}function g(t){var e=new Date;return e=e.getTime()/1e3,parseInt(e)}function o(){var t=(new Date).getTime();return uni.setStorageSync("Set__First__Time",t),uni.removeStorageSync("Set__Last__Time"),t}function c(){var t=(new Date).getTime();return uni.setStorageSync("Set__Last__Time",t),t}function l(t){var e=uni.getStorageSync("Set__First__Time")||0,a=(uni.getStorageSync("Set__Last__Time")||0)-e;return a=(a=parseInt(a/1e3))<1?1:a,"app"===t?{residenceTime:a,overtime:300<a}:"page"!==t?{residenceTime:a}:{residenceTime:a,overtime:1800<a}}function h(t){var e=t.self,a=t._query,i=a&&"{}"!==JSON.stringify(a)?"?"+JSON.stringify(a):"";return t._query="","bd"===T()?e.$mp&&e.$mp.page.is+i:e.$mp&&e.$mp.page.route+i}function f(t){if("string"==typeof t)return{check:255<t.length,msg:" 的长度超过 255 个字符"};if("object"!==u(t))return!1;var e=!1;for(var a in t)if("string"!=typeof t[a]){e=!0;break}return{check:e,msg:" 对象的值只能为 string 类型"}}function v(t){return!!("page"===t.mpType||t.$mp&&"page"===t.$mp.mpType)}function d(t){H.load(t,this)}function y(t){H.show(this)}function m(t){H.hide(this)}function D(){H.hide(this)}function S(t){H.error(t)}function k(t){H.interceptShare(!1)}var q,R,T=function(){var t="";switch(process.env.VUE_APP_PLATFORM){case"app-plus":t="n";break;case"h5":t="h5";break;case"mp-weixin":t="wx";break;case"mp-alipay":t="ali";break;case"mp-baidu":t="bd";break;case"mp-toutiao":t="tt";break;case"mp-qq":t="qq"}return t},w=require('uni-pages?{"type":"style"}').default,b=require("./dcloud-stat-config.js"),E=(q=uni.getStorageSync("uuid"),"n"===T()?(q=plus.runtime.getDCloudId(),uni.setStorageSync("uuid",q),console.log("app uuid",q)):q&&36===q.length||(q=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(t){return(t^(void 0!==r&&r.getRandomValues?r.getRandomValues(new Uint8Array(1))[0]:Math.floor(255*Math.random()))&15>>t/4).toString(16)}),uni.setStorageSync("uuid",q)),q),N=T(),I="n"===T()?plus.runtime.version:"",O=(R="","n"===T()&&(R=plus.runtime.channel),R),V=g(),L=uni.getSystemInfoSync(),P=new(function(){function t(){i(this,t),this.self="",this._retry=0,this._platform="",this._query={},this._navigationBarTitle={config:"",page:"",report:"",lt:""},this._operatingTime=0,this._reportingRequestData={1:[],11:[]},this.__prevent_triggering=!1,this.__licationHide=!1,this.__licationShow=!1,this._lastPageRoute="",this.statData={uuid:E,ut:N,ak:b.app_key,usv:p,v:I,ch:O,cn:"",pn:"",ct:"",t:V,tt:""}}return s(t,[{key:"_applicationShow",value:function(){if(this.__licationHide){if(c(),l("app").overtime){var t={path:this._lastPageRoute,scene:this.statData.sc};this._sendReportRequest(t)}this.__licationShow=!0,this.__licationHide=!1}}},{key:"_applicationHide",value:function(t,e){this.__licationHide=!0,c();var a=l();o(),this._sendHideRequest({urlref:this._lastPageRoute,urlref_ts:a.residenceTime},e)}},{key:"_pageShow",value:function(t){var e=h(this),a=function(t){var e=t.self;return"bd"===T()?e.$mp&&e.$mp.page.is:e.$mp&&e.$mp.page.route}(this);if(this._navigationBarTitle.config=w&&w.pages[a].titleNView&&w.pages[a].titleNView.titleText||w&&w.pages[a].navigationBarTitleText||"",this.__licationShow)return this.__licationShow=!1,o(),void(this._lastPageRoute=e);c();var i=l("page");if(o(),i.overtime){var n={path:this._lastPageRoute,scene:this.statData.sc};this._sendReportRequest(n)}else this._sendPageRequest({url:e,urlref:this._lastPageRoute,urlref_ts:i.residenceTime});this._lastPageRoute=e}},{key:"_pageHide",value:function(t){if(!this.__licationHide){var e=this._navigationBarTitle;return this._reportingRequestData[e.lt]&&(this._reportingRequestData[e.lt][this._reportingRequestData[e.lt].length-1].ttpj=e.config,this._reportingRequestData[e.lt][this._reportingRequestData[e.lt].length-1].ttn=e.page,this._reportingRequestData[e.lt][this._reportingRequestData[e.lt].length-1].ttc=e.report),void(P._navigationBarTitle={config:"",page:"",report:"",lt:""})}}},{key:"_login",value:function(){this._sendEventRequest({key:"__uni__login"},0)}},{key:"_share",value:function(){this._sendEventRequest({key:"__uni__share"},0)}},{key:"_payment",value:function(t){this._sendEventRequest({key:t},0)}},{key:"_sendReportRequest",value:function(t,e){this._navigationBarTitle.lt="1";var a=t.query&&"{}"!==JSON.stringify(t.query)?"?"+JSON.stringify(t.query):"";this.statData.lt="1",this.statData.url=t.path+a,this.statData.t=g(),this.statData.sc=function(t){var e=T(),a="";return t||("wx"===e&&(a=uni.getLaunchOptionsSync().scene),a)}(t.scene),this.statData.fvts=function(){var t=uni.getStorageSync("First__Visit__Time"),e=0;return t?e=t:(e=g(),uni.setStorageSync("First__Visit__Time",e),uni.removeStorageSync("Last__Visit__Time")),e}(),this.statData.lvts=function(){var t=uni.getStorageSync("Last__Visit__Time"),e=0;return e=t||"",uni.setStorageSync("Last__Visit__Time",g()),e}(),this.statData.tvc=function(){var t=uni.getStorageSync("Total__Visit__Count"),e=1;return t&&(e=t,e++),uni.setStorageSync("Total__Visit__Count",e),e}(),this.getDeviceInfo()}},{key:"_sendPageRequest",value:function(t){var e=t.url,a=t.urlref,i=t.urlref_ts;this._navigationBarTitle.lt="11";var n={ak:this.statData.ak,uuid:this.statData.uuid,lt:"11",ut:this.statData.ut,url:e,tt:this.statData.tt,urlref:a,urlref_ts:i,ch:this.statData.ch,usv:this.statData.usv,t:g(),p:this.statData.p};this.request(n)}},{key:"_sendHideRequest",value:function(t,e){var a=t.urlref,i=t.urlref_ts,n={ak:this.statData.ak,uuid:this.statData.uuid,lt:"3",ut:this.statData.ut,urlref:a,urlref_ts:i,ch:this.statData.ch,usv:this.statData.usv,t:g(),p:this.statData.p};this.request(n,e)}},{key:"_sendEventRequest",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},a=e.key,i=void 0===a?"":a,n=e.value,s=void 0===n?"":n,r=h(this),o={ak:this.statData.ak,uuid:this.statData.uuid,lt:"21",ut:this.statData.ut,url:r,ch:this.statData.ch,e_n:i,e_v:"object"===u(s)?JSON.stringify(s):s.toString(),usv:this.statData.usv,t:g(),p:this.statData.p};this.request(o)}},{key:"getDeviceInfo",value:function(){process.env.NODE_ENV;var t=L.platform;this._platform=t,this.statData.p="android"===L.platform?"a":"i",this.statData.brand=L.brand||"",this.statData.md=L.model,this.statData.sv=L.system.replace(/(Android|iOS)\s/,""),this.statData.mpsdk=L.SDKVersion||"",this.statData.mpv=L.version||"",this.statData.lang=L.language,this.statData.pr=L.pixelRatio,this.statData.ww=L.windowWidth,this.statData.wh=L.windowHeight,this.statData.sw=L.screenWidth,this.statData.sh=L.screenHeight,this.getNetworkInfo()}},{key:"getNetworkInfo",value:function(){var e=this;uni.getNetworkType({success:function(t){e.statData.net=t.networkType,e.getLocation()}})}},{key:"getLocation",value:function(){var e=this;b.getLocation?uni.getLocation({type:"wgs84",geocode:!0,success:function(t){t.address&&(e.statData.cn=t.address.country,e.statData.pn=t.address.province,e.statData.ct=t.address.city),e.statData.lat=t.latitude,e.statData.lng=t.longitude,e.request(e.statData)}}):(this.statData.lat=0,this.statData.lng=0,this.request(this.statData))}},{key:"request",value:function(e,t){var a=this,i=g(),n=this._operatingTime;this._reportingRequestData[e.lt]||(this._reportingRequestData[e.lt]=[]),this._reportingRequestData[e.lt].push(e);var s=this._navigationBarTitle;if(this._reportingRequestData[s.lt]&&(this._reportingRequestData[s.lt][this._reportingRequestData[s.lt].length-1].ttn=s.page,this._reportingRequestData[s.lt][this._reportingRequestData[s.lt].length-1].ttpj=s.config,this._reportingRequestData[s.lt][this._reportingRequestData[s.lt].length-1].ttc=s.report),!(i-n<10)||t){this._operatingTime=g();var r=[],o=[],u=[],c=function(i){a._reportingRequestData[i].forEach(function(t,e){var a=function(t){var e="";for(var a in t)e+=a+"="+t[a]+"&";return e=e.substr(0,e.length-1)}(t);0===i?r.push(a):3===i?u.push(a):o.push(a)})};for(var l in this._reportingRequestData)c(l);r.push.apply(r,o.concat(u));var h={usv:p,t:i,requests:JSON.stringify(r)};h.si=_(h).sign,this._reportingRequestData={},"h5"!==e.ut?uni.request({url:"https://tongji.dcloud.net.cn/uni/stat",method:"POST",data:h,success:function(t){"development"===process.env.NODE_ENV&&console.log("stat request success")},fail:function(t){"development"===process.env.NODE_ENV&&console.log("stat request fail",t),++a._retry<3&&setTimeout(function(){a.request(e)},1e3)}}):this.imageRequest(h)}}},{key:"imageRequest",value:function(t){var e=new Image,a=_(function(t){var e={};for(var a in t)e[a]=encodeURIComponent(t[a]);return e}(t)).options;e.src="https://tongji.dcloud.net.cn/uni/stat.gif?"+a}}]),t}()),H=new(function(){function t(){i(this,t),this.addInterceptorInit(),this.interceptLogin(),this.interceptShare(!0),this.interceptRequestPayment()}return s(t,[{key:"addInterceptorInit",value:function(){uni.addInterceptor("setNavigationBarTitle",{invoke:function(t){P._navigationBarTitle.page=t.title}})}},{key:"interceptLogin",value:function(){uni.addInterceptor("login",{invoke:function(){},complete:function(t){P._login()}})}},{key:"interceptShare",value:function(t){t?uni.addInterceptor("share",{invoke:function(){},success:function(t){P._share()},fail:function(){P._share()}}):P._share()}},{key:"interceptRequestPayment",value:function(){uni.addInterceptor("requestPayment",{invoke:function(){},success:function(t){P._payment("__uni__pay_success")},fail:function(){P._payment("__uni__pay_fail")}})}},{key:"report",value:function(t,e){P.self=e,"development"===process.env.NODE_ENV&&console.log("report init"),P._operatingTime=g(),P.__licationShow=!0,P._sendReportRequest(t,!0)}},{key:"load",value:function(t,e){P._query=t}},{key:"show",value:function(t){P.self=t,v(t)?P._pageShow(t):P._applicationShow(t)}},{key:"hide",value:function(t){P.self=t,v(t)?P._pageHide(t):P._applicationHide(t,!0)}},{key:"error",value:function(t){if("devtools"!==P._platform){var e="";e=t.message?t.message:JSON.stringify(t).substr(0,255).replace(/\\n/g," ").replace(/\s+/g," ").replace(/\\/g,"").replace(/\"/g,"'");var a={ak:P.statData.ak,uuid:P.statData.uuid,lt:"31",ut:P.statData.ut,ch:P.statData.ch,mpsdk:P.statData.mpsdk,mpv:P.statData.mpv,v:P.statData.v,em:e,usv:P.statData.usv,t:g(),p:P.statData.p};P.request(a)}else"development"===process.env.NODE_ENV&&console.info("当前运行环境为开发者工具，不上报数据。")}},{key:"sendEvent",value:function(t,e){var a=f(t),i=f(e);e?a.check?console.error("自定义事件的 key"+a.msg):i.check?console.error("自定义事件的 value"+i.msg):P._sendEventRequest({key:t,value:e},1):console.error("自定义事件 value 不能为空")}},{key:"seedReportEvent",value:function(t){var e=t.title;t.url;P._navigationBarTitle.report=e}}]),t}());a(e,"onLaunch",function(t){H.report(t,this)}),a(e,"onLoad",d),a(e,"onShow",y),a(e,"onHide",m),a(e,"onUnload",D),a(e,"onError",S),a(e,"onShareAppMessage",k),t.mixin(e),t.prototype.$stat={sendEvent:H.sendEvent,report:H.seedReportEvent}});
